# Go Pro - Golang ä¼ä¸šçº§å®æˆ˜é¡¹ç›®æ¨¡ç‰ˆ

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº Golang çš„é«˜æ ‡å‡†ã€ä¼ä¸šçº§åç«¯æœåŠ¡æ¨¡ç‰ˆï¼Œé›†æˆäº†ç°ä»£ Web å¼€å‘æ‰€éœ€çš„å„é¡¹æ ¸å¿ƒèƒ½åŠ›ï¼ŒåŒ…æ‹¬ä¾èµ–æ³¨å…¥ã€è®¤è¯é‰´æƒã€ç¼“å­˜ã€æ•°æ®åº“æ“ä½œå’Œå•å…ƒæµ‹è¯•ç­‰æœ€ä½³å®è·µã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

*   **åˆ†å±‚æ¶æ„**: æ¸…æ™°çš„ `Handler` -> `Service` -> `Repository` åˆ†å±‚è®¾è®¡ã€‚
*   **ä¾èµ–æ³¨å…¥**: ä½¿ç”¨ **Google Wire** è¿›è¡Œç¼–è¯‘æœŸä¾èµ–æ³¨å…¥ï¼Œä»£ç è§£è€¦æ›´å½»åº•ã€‚
*   **è®¤è¯é‰´æƒ**: åŸºäº **JWT (JSON Web Token)** çš„æ— çŠ¶æ€è®¤è¯æœºåˆ¶ï¼ŒåŒ…å«ä¸­é—´ä»¶å®ç°ã€‚
*   **å®‰å…¨é˜²æŠ¤**: ä½¿ç”¨ **Bcrypt** å¯¹ç”¨æˆ·å¯†ç è¿›è¡Œå¼ºå“ˆå¸ŒåŠ å¯†ã€‚
*   **é«˜æ€§èƒ½ç¼“å­˜**: é›†æˆ **Redis** ç¼“å­˜ï¼Œæ¼”ç¤ºäº†â€œCache-Asideâ€æ¨¡å¼ã€‚
*   **æ•°æ®åº“**: ä½¿ç”¨ **GORM** æ“ä½œæ•°æ®åº“ (é»˜è®¤ SQLiteï¼Œå¯æ— ç¼åˆ‡æ¢ MySQL)ã€‚
*   **é…ç½®ç®¡ç†**: ä½¿ç”¨ **Viper** ç®¡ç†å¤šç¯å¢ƒé…ç½®ã€‚
*   **å•å…ƒæµ‹è¯•**: é›†æˆ **Testify** å’Œ **Mockgen**ï¼Œæä¾›å¯æµ‹è¯•æ€§è®¾è®¡å’Œ Mock ç¤ºä¾‹ã€‚
*   **ç»“æ„åŒ–æ—¥å¿—**: ä½¿ç”¨ **Zap** è¿›è¡Œé«˜æ€§èƒ½æ—¥å¿—è®°å½•ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
go_pro/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â”œâ”€â”€ main.go         # ç¨‹åºå…¥å£
â”‚       â”œâ”€â”€ wire.go         # Wire ä¾èµ–æ³¨å…¥å®šä¹‰
â”‚       â””â”€â”€ wire_gen.go     # Wire ç”Ÿæˆçš„ä»£ç 
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶åŠåŠ è½½é€»è¾‘
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ handler/            # HTTP è¯·æ±‚å¤„ç†å±‚
â”‚   â”œâ”€â”€ middleware/         # Gin ä¸­é—´ä»¶ (å¦‚ Auth)
â”‚   â”œâ”€â”€ service/            # ä¸šåŠ¡é€»è¾‘å±‚ (åŒ…å«ç¼“å­˜ã€äº‹åŠ¡ç­‰)
â”‚   â”œâ”€â”€ repository/         # æ•°æ®è®¿é—®å±‚ (å®šä¹‰æ¥å£å’Œå®ç°)
â”‚   â”‚   â””â”€â”€ mock/           # Mock ç”Ÿæˆä»£ç 
â”‚   â””â”€â”€ model/              # æ•°æ®åº“æ¨¡å‹
â”œâ”€â”€ pkg/
â”‚   â”œâ”€â”€ cache/              # Redis å®¢æˆ·ç«¯å°è£…
â”‚   â”œâ”€â”€ database/           # GORM æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”œâ”€â”€ logger/             # Zap æ—¥å¿—å°è£…
â”‚   â””â”€â”€ utils/              # é€šç”¨å·¥å…· (JWT, Password)
â”œâ”€â”€ router/                 # è·¯ç”±å®šä¹‰
â”œâ”€â”€ go.mod                  # ä¾èµ–ç®¡ç†
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿å·²å®‰è£… Go 1.20+ å’Œ Redisã€‚

```bash
# å®‰è£… Wire å·¥å…·
go install github.com/google/wire/cmd/wire@latest

# å®‰è£… Mockgen å·¥å…·
go install go.uber.org/mock/mockgen@latest
```

### 2. å¯åŠ¨ Redis

ç¡®ä¿æœ¬åœ° Redis è¿è¡Œåœ¨é»˜è®¤ç«¯å£ `6379`ï¼Œæˆ–è€…ä¿®æ”¹ `config/config.yaml`ã€‚

### 3. è¿è¡Œé¡¹ç›®

```bash
# æ•´ç†ä¾èµ–
go mod tidy

# é‡æ–°ç”Ÿæˆä¾èµ–æ³¨å…¥ä»£ç  (å¦‚æœä¿®æ”¹äº†ä¾èµ–å…³ç³»)
wire cmd/server/wire.go

# å¯åŠ¨æœåŠ¡
go run cmd/server/main.go
```

### 4. è¿è¡Œæµ‹è¯•

```bash
go test ./internal/service/...
```

## ğŸ§ª æ¥å£æµ‹è¯•

### 1. æ³¨å†Œç”¨æˆ·

```bash
curl -X POST http://localhost:8080/api/v1/register \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "email": "admin@example.com", "password": "securepassword"}'
```

### 2. ç™»å½• (è·å– Token)

```bash
curl -X POST http://localhost:8080/api/v1/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "securepassword"}'
```

å“åº”ç¤ºä¾‹:
```json
{
    "token": "eyJhbGciOiJIUzI1NiIs...",
    "user": { ... }
}
```

### 3. è·å–ç”¨æˆ·åˆ—è¡¨ (éœ€è¦ Token)

å°†ä¸Šä¸€æ­¥è·å–çš„ Token æ›¿æ¢åˆ° Header ä¸­ï¼š

```bash
curl http://localhost:8080/api/v1/users \
  -H "Authorization: Bearer <YOUR_TOKEN>"
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–° API æµç¨‹

1.  **Repository**: åœ¨ `internal/repository` å®šä¹‰æ¥å£å’Œå®ç°ï¼Œæ“ä½œæ•°æ®åº“ã€‚
2.  **Service**: åœ¨ `internal/service` ç¼–å†™ä¸šåŠ¡é€»è¾‘ï¼Œæ³¨å…¥ Repositoryã€‚
3.  **Handler**: åœ¨ `internal/handler` å¤„ç† HTTP è¯·æ±‚ï¼Œæ³¨å…¥ Serviceã€‚
4.  **Wire**: åœ¨ `cmd/server/wire.go` ä¸­æ·»åŠ æ–°çš„ Providerã€‚
5.  **Router**: åœ¨ `router/router.go` æ³¨å†Œè·¯ç”±ã€‚
6.  **Generate**: è¿è¡Œ `wire cmd/server/wire.go` æ›´æ–°ä¾èµ–æ³¨å…¥ã€‚

### Mock æµ‹è¯•ç”Ÿæˆ

å¦‚æœä¿®æ”¹äº† Repository æ¥å£ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆ Mockï¼š

```bash
mockgen -source=internal/repository/user_repo.go -destination=internal/repository/mock/user_repo_mock.go -package=mock
```

---
Generated by Trae AI
